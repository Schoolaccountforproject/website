{% extends "main structures/base.html" %}

{% block body %}
<h1>Welcome to My Website, Orbs!</h1>
<div class="container">
    {% with messages = get_flashed_messages()%}
        {% if messages %}
            {% for msg in messages %}
                <p>{{msg}}</p>
            {% endfor %}
        {% endif %}
    {% endwith %}
    <form id="auth-form" action="{{ url_for('login') }}" method="post">
        <p>You can make an account first with just username and password</p>
        <input type="text" name="username" placeholder="Username" autocomplete="off" required>
        <input type="text" name="email" placeholder="Email (optional)" autocomplete="off">
        <input type="password" name="password" placeholder="Password" autocomplete="off" required>
        <input type="submit" value="Login" onclick="setFormAction('login')">
        <input type="button" value="Register" onclick="setFormAction('register')">
        <input type="button" class="btn login-google" value="Login with Google" onclick="window.location.href = '{{ url_for('login_google')}}'">
    </form>
</div>

<script>
    function setFormAction(action) {
        let form = document.getElementById('auth-form');
        // We grab the entire html file here 
        if (action === 'login') {
            form.action = "{{ url_for('login') }}";
            form.method = "post";
            form.submit();
        } else if (action === 'register') {
            form.action = "{{ url_for('register') }}";
            form.method = "post";
            form.submit();
        } 
    }
</script>
{% endblock %}